<template name="pollDetail">
  <div class="overlay">
  <div class="bk-btn">
    <div class="bk-btn-triangle"></div>
    <div class="bk-btn-bar"></div>
  </div>
    <div class="card-grid">
      {{#each poll in selectedPoll}} 
      {{#if pollisSurvey poll}} 
      <div class="card-fixed card-item-wide">
        <div class="survey-title">
          <div class="poll-title">{{poll.pollTitle}} 
            <i class="fa fa-trash" style="font-size:25px;"></i>
            <i class="fa fa-envelope" style="font-size:27px"></i>
          </div>
        </div>

        <nav class="page-navigation">
          <ul>
            <li >
              <a href="#survey-details">
                <button type="button" class="nav-button cancel-button">Survey Details</button>
              </a>
             
            </li>
            {{#each question in pollQuestionsNav poll}}
            <li>
              <a href="#{{question.section}}">
                <button type="button" class="nav-button cancel-button">{{question.num}}</button>
              </a>
            </li>
           {{/each}}
          </ul>
        </nav>
        </div>
        <!-- <div id="filler">&nbsp;</div> -->
        <section id="section0" class="card-item-wide">
            <table>
              <tr>
                <td>Status : </td>
                <td>{{poll.pollState}}</td>
                <td>
          
                </td>
              </tr>
              <tr>
                <td>Space:</td>
                <td>{{poll.pollTargetRoomName}}</td>
                <td></td>
              </tr>
              <tr>
                <td>Created:</td>
                <td>{{retrieveDate poll.createdAt}}</td>
                <td></td>
              </tr>
              <tr>
                <td>Total Responses :</td>
                <td>{{totalResponse poll.questions}}</td>
                <td></td>
              </tr>
            </table>
        </section>

       {{#each question in pollQuestionsNav poll}}
       <section id="{{question.section}}" class="card-item-wide">
        <div class="vertical">
          <div class="survey">
            <div class="survey-question">{{question.ques.text}}</div>
            {{#each option in options question.ques}}
              <div class="survey-options">{{option.optionChar}}. {{option.optionText}}</div>
            {{/each}}
          </div>
          <div class="responses-list">
            {{#each response in responsesCalc question.ques}}
            <div class="responses">
              <div class="progress --vr">
                <div class="progress-bar " style="height:{{response.percentage}}%">
                  {{#if responseTotaNotZero response.total}} 
                    {{response.total}} 
                  {{/if}}
                </div>
              </div>
              <div class="option-char" value="{{response.optionChar}}">
                {{response.optionChar}}
              </div>
            </div>
            {{/each}}
          </div>

          <div class="percentages-list">
            {{#if hoverQuestion question.num}}
              {{#each response in responsesCalc question.ques}}
               {{#if hoverOption response.optionChar}}
                <div class="percentages">
                  {{#if response.percentage}}
                  <div class="poll-percentage">
                    <div class="poll-percentage-number">{{response.percentage}}%</div>
                    <div class="poll-highest-option"></div>
                  </div>
                  {{else}}
                  <div class="poll-percentage">
                    <div class="poll-percentage-number">0%</div>
                    <div class="poll-highest-option"></div>
                  </div>
                  {{/if}}
                  <div class="total-responses">
                    <div class="total-responses-number">{{response.total}}</div>
                    Responses
                  </div>
                </div>
                 {{/if}}
               {{/each}}
               {{/if}}

              {{#if showhighestPoll question.num}}
              {{#each highestPoll in highestPollPercentage question.ques}}
              <div class="percentages">
                {{#if highestPoll.percentage}}
                <div class="poll-percentage highest">
                  <div class="poll-percentage-number">{{highestPoll.percentage}}%</div>
                  <div class="poll-highest-option">{{highestPoll.optionChar}}. {{highestPoll.option}}</div>
                </div>
                {{else}}
                <div class="poll-percentage highest">
                  <div class="poll-percentage-number">0%</div>
                  <div class="poll-highest-option"></div>
                </div>
                {{/if}}
                <div class="total-responses highest">
                  <div class="total-responses-number">{{highestPoll.totalResponse}}</div>
                  Responses
                </div>
              </div>
               {{/each}}
              {{/if}}

          </div>
        </div>
       </section>

        {{/each}}
      
      {{else}}
      <!-- For Poll -->
       {{#each question in pollQuestionsNav poll}}
      <div class="card-item-wide">
        <h1>{{poll.pollTitle}}</h1>
        <div class="poll-question">{{pollQuestion poll}}</div>
        <div class="poll-options-list">
          {{#each option in options question.ques}}
          <div class="poll-option">
            {{option.optionChar}}. {{option.optionText}}
          </div>
          {{/each}}
        </div>
      </div>

      <div class="card-item-wide">
        <div class="vertical">
          <div class="poll-responses-list">
            {{#each response in responsesCalc question.ques}}
            <div class="responses">
              <div class="progress --vr">
                <div class="progress-bar " style="height:{{response.percentage}}%">
                  {{#if responseTotaNotZero response.total}} {{response.total}} {{/if}}
                </div>
              </div>
              <div class="option-char" value="{{response.optionChar}}">
                {{response.optionChar}}
              </div>
            </div>
            {{/each}}
          </div>

          <div class="percentages-list">
            {{#if hoverQuestion question.num}} {{#each response in responsesCalc question.ques}} {{#if hoverOption response.optionChar}}
            <div class="percentages">
              {{#if response.percentage}}
              <div class="poll-percentage">
                <div class="poll-percentage-number">{{response.percentage}}%</div>
                <div class="poll-highest-option"></div>
              </div>
              {{else}}
              <div class="poll-percentage">
                <div class="poll-percentage-number">0%</div>
                <div class="poll-highest-option"></div>
              </div>
              {{/if}}
              <div class="total-responses">
                <div class="total-responses-number">{{response.total}}</div>
                  Responses
              </div>
            </div>
            {{/if}} {{/each}} {{/if}} {{#if showhighestPoll question.num}} {{#each highestPoll in highestPollPercentage question.ques}}
            <div class="percentages">
              {{#if highestPoll.percentage}}
              <div class="poll-percentage highest">
                <div class="poll-percentage-number">{{highestPoll.percentage}}%</div>
                <div class="poll-highest-option">{{highestPoll.optionChar}}. {{highestPoll.option}}</div>
              </div>
              {{else}}
              <div class="poll-percentage highest">
                <div class="poll-percentage-number">0%</div>
                <div class="poll-highest-option"></div>
              </div>
              {{/if}}
              <div class="total-responses highest">
                <div class="total-responses-number">{{highestPoll.totalResponse}}</div>
                Responses
              </div>
            </div>
            {{/each}} {{/if}}
          </div>

        </div>
      </div>
      {{/each}}

      <div class="card-item-wide">
        <table>
          <tr>
            <td>Status : </td>
            <td>{{poll.pollState}}</td>
            <td>
              <i class="fa fa-trash" style="font-size:25px;"></i>
              <i class="fa fa-envelope" style="font-size:27px"></i>
            </td>
          </tr>
          <tr>
            <td>Space:</td>
            <td>{{poll.pollTargetRoomName}}</td>
            <td></td>
          </tr>
          <tr>
            <td>Created:</td>
            <td>{{retrieveDate poll.createdAt}}</td>
            <td></td>
          </tr>
          <tr>
            <td>Total Responses :</td>
            <td>{{totalResponse poll.questions}}</td>
            <td></td>
          </tr>
        </table>
      </div>
      {{/if}}
      {{/each}}
    </div>
  </div>
  {{> endPollModal}}
</template>


<template name="endPollModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-body">
          <p>Do you want to end the poll ?</p>
        </div>

        <div class="modal-footer">
          <button type="button" class="cancel-button" data-dismiss="modal">Cancel</button>
          <button type="button" class="active-button" data-dismiss="modal">End Poll</button>
        </div>

      </div>
    </div>
  </div>
</template>

<template name="emailPollModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-body">
          <p>Do you want to email the poll results?</p>
        </div>

        <div class="modal-footer">
          <button type="button" class="cancel-button" data-dismiss="modal">Cancel</button>
          <button type="button" class="active-button" data-dismiss="modal">Email Results</button>
        </div>

      </div>
    </div>
  </div>
</template>